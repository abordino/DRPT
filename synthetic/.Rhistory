library(cranlogs)
library(dplyr)
library(ggplot2)
# DRPT hit CRAN on 2025-07-07; start there
start_date <- as.Date("2022-07-07")
end_date   <- Sys.Date()
dl <- cran_downloads("MCARtest",                       # package name
from = start_date,
to   = end_date) |>
mutate(date = as.Date(date))                 # ensure Date class
ggplot(dl, aes(date, count)) +
geom_col(width = 0.8) +
geom_smooth(method = "loess", se = FALSE) +
labs(title = "Daily CRAN downloads of DRPT",
x = NULL, y = "Downloads")
library(cranlogs)
library(dplyr)
library(ggplot2)
# DRPT hit CRAN on 2025-07-07; start there
start_date <- as.Date("2022-07-07")
end_date   <- Sys.Date()
dl <- cran_downloads("DRPT",                       # package name
from = start_date,
to   = end_date) |>
mutate(date = as.Date(date))                 # ensure Date class
ggplot(dl, aes(date, count)) +
geom_col(width = 0.8) +
geom_smooth(method = "loess", se = FALSE) +
labs(title = "Daily CRAN downloads of DRPT",
x = NULL, y = "Downloads")
library(cranlogs)
library(dplyr)
library(ggplot2)
# DRPT hit CRAN on 2025-07-07; start there
start_date <- as.Date("2025-07-07")
end_date   <- Sys.Date()
dl <- cran_downloads("DRPT",                       # package name
from = start_date,
to   = end_date) |>
mutate(date = as.Date(date))                 # ensure Date class
ggplot(dl, aes(date, count)) +
geom_col(width = 0.8) +
geom_smooth(method = "loess", se = FALSE) +
labs(title = "Daily CRAN downloads of DRPT",
x = NULL, y = "Downloads")
dl
library(cranlogs)
library(dplyr)
library(ggplot2)
# DRPT hit CRAN on 2025-07-07; start there
start_date <- as.Date("2025-07-07")
end_date   <- Sys.Date()
dl <- cran_downloads("DRPT",                       # package name
from = start_date,
to   = end_date) |>
mutate(date = as.Date(date))                 # ensure Date class
ggplot(dl, aes(date, count)) +
geom_col(width = 0.8) +
geom_smooth(method = "loess", se = FALSE) +
labs(title = "Daily CRAN downloads of DRPT",
x = NULL, y = "Downloads")
library(cranlogs)
library(dplyr)
library(ggplot2)
# DRPT hit CRAN on 2025-07-07; start there
start_date <- as.Date("2025-07-07")
end_date   <- Sys.Date()
dl <- cran_downloads("DRPT",                       # package name
from = start_date,
to   = end_date) |>
mutate(date = as.Date(date))                 # ensure Date class
ggplot(dl, aes(date, count)) +
geom_col(width = 0.8) +
geom_smooth(method = "loess", se = FALSE) +
labs(title = "Daily CRAN downloads of DRPT",
x = NULL, y = "Downloads")
dl
library(cranlogs)
library(dplyr)
library(ggplot2)
# DRPT hit CRAN on 2025-07-07; start there
start_date <- as.Date("2025-07-07")
end_date   <- Sys.Date()
dl <- cran_downloads("DRPT",                       # package name
from = start_date,
to   = end_date) |>
mutate(date = as.Date(date))                 # ensure Date class
ggplot(dl, aes(date, count)) +
geom_col(width = 0.8) +
geom_smooth(method = "loess", se = FALSE) +
labs(title = "Daily CRAN downloads of DRPT",
x = NULL, y = "Downloads")
sum(dl$count)
library(cranlogs)
library(dplyr)
library(ggplot2)
# DRPT hit CRAN on 2025-07-07; start there
start_date <- as.Date("2025-07-07")
end_date   <- Sys.Date()
dl <- cran_downloads("DRPT",                       # package name
from = start_date,
to   = end_date) |>
mutate(date = as.Date(date))                 # ensure Date class
ggplot(dl, aes(date, count)) +
geom_col(width = 0.8) +
geom_smooth(method = "loess", se = FALSE) +
labs(title = "Daily CRAN downloads of DRPT",
x = NULL, y = "Downloads")
library(cranlogs)
library(dplyr)
library(ggplot2)
# DRPT hit CRAN on 2025-07-07; start there
start_date <- as.Date("2025-07-07")
end_date   <- Sys.Date()
dl <- cran_downloads("DRPT",                       # package name
from = start_date,
to   = end_date) |>
mutate(date = as.Date(date))                 # ensure Date class
ggplot(dl, aes(date, count)) +
geom_col(width = 0.8) +
geom_smooth(method = "loess", se = FALSE) +
labs(title = "Daily CRAN downloads of DRPT",
x = NULL, y = "Downloads")
sum(dl$count)
library(cranlogs)
library(dplyr)
library(ggplot2)
# DRPT hit CRAN on 2025-07-07; start there
start_date <- as.Date("2025-07-07")
end_date   <- Sys.Date()
dl <- cran_downloads("DRPT",                       # package name
from = start_date,
to   = end_date) |>
mutate(date = as.Date(date))                 # ensure Date class
ggplot(dl, aes(date, count)) +
geom_col(width = 0.8) +
geom_smooth(method = "loess", se = FALSE) +
labs(title = "Daily CRAN downloads of DRPT",
x = NULL, y = "Downloads")
library(cranlogs)
library(dplyr)
library(ggplot2)
# DRPT hit CRAN on 2025-07-07; start there
start_date <- as.Date("2025-07-07")
end_date   <- Sys.Date()
dl <- cran_downloads("DRPT",                       # package name
from = start_date,
to   = end_date) |>
mutate(date = as.Date(date))                 # ensure Date class
ggplot(dl, aes(date, count)) +
geom_col(width = 0.8) +
geom_smooth(method = "loess", se = FALSE) +
labs(title = "Daily CRAN downloads of DRPT",
x = NULL, y = "Downloads")
library(cranlogs)
library(dplyr)
library(ggplot2)
# DRPT hit CRAN on 2025-07-07; start there
start_date <- as.Date("2025-07-07")
end_date   <- Sys.Date()
dl <- cran_downloads("DRPT",                       # package name
from = start_date,
to   = end_date) |>
mutate(date = as.Date(date))                 # ensure Date class
ggplot(dl, aes(date, count)) +
geom_col(width = 0.8) +
geom_smooth(method = "loess", se = FALSE) +
labs(title = "Daily CRAN downloads of DRPT",
x = NULL, y = "Downloads")
library(cranlogs)
library(dplyr)
library(ggplot2)
# DRPT hit CRAN on 2025-07-07; start there
start_date <- as.Date("2025-07-07")
end_date   <- Sys.Date()
dl <- cran_downloads("DRPT",                       # package name
from = start_date,
to   = end_date) |>
mutate(date = as.Date(date))                 # ensure Date class
ggplot(dl, aes(date, count)) +
geom_col(width = 0.8) +
geom_smooth(method = "loess", se = FALSE) +
labs(title = "Daily CRAN downloads of DRPT",
x = NULL, y = "Downloads")
library(cranlogs)
library(dplyr)
library(ggplot2)
# DRPT hit CRAN on 2025-07-07; start there
start_date <- as.Date("2025-07-07")
end_date   <- Sys.Date()
dl <- cran_downloads("DRPT",                       # package name
from = start_date,
to   = end_date) |>
mutate(date = as.Date(date))                 # ensure Date class
ggplot(dl, aes(date, count)) +
geom_col(width = 0.8) +
geom_smooth(method = "loess", se = FALSE) +
labs(title = "Daily CRAN downloads of DRPT",
x = NULL, y = "Downloads")
library(cranlogs)
library(dplyr)
library(ggplot2)
# DRPT hit CRAN on 2025-07-07; start there
start_date <- as.Date("2025-07-07")
end_date   <- Sys.Date()
dl <- cran_downloads("DRPT",                       # package name
from = start_date,
to   = end_date) |>
mutate(date = as.Date(date))                 # ensure Date class
ggplot(dl, aes(date, count)) +
geom_col(width = 0.8) +
geom_smooth(method = "loess", se = FALSE) +
labs(title = "Daily CRAN downloads of DRPT",
x = NULL, y = "Downloads")
sum(dl$count)
library(cranlogs)
library(dplyr)
library(ggplot2)
# DRPT hit CRAN on 2025-07-07; start there
start_date <- as.Date("2025-07-07")
end_date   <- Sys.Date()
dl <- cran_downloads("DRPT",                       # package name
from = start_date,
to   = end_date) |>
mutate(date = as.Date(date))                 # ensure Date class
ggplot(dl, aes(date, count)) +
geom_col(width = 0.8) +
geom_smooth(method = "loess", se = FALSE) +
labs(title = "Daily CRAN downloads of DRPT",
x = NULL, y = "Downloads")
library(cranlogs)
library(dplyr)
library(ggplot2)
# DRPT hit CRAN on 2025-07-07; start there
start_date <- as.Date("2023-07-07")
end_date   <- Sys.Date()
dl <- cran_downloads("MCARtest",                       # package name
from = start_date,
to   = end_date) |>
mutate(date = as.Date(date))                 # ensure Date class
ggplot(dl, aes(date, count)) +
geom_col(width = 0.8) +
geom_smooth(method = "loess", se = FALSE) +
labs(title = "Daily CRAN downloads of DRPT",
x = NULL, y = "Downloads")
sum(dl$count)
library(cranlogs)
library(dplyr)
library(ggplot2)
# DRPT hit CRAN on 2025-07-07; start there
start_date <- as.Date("2025-07-07")
end_date   <- Sys.Date()
dl <- cran_downloads("DRPT",                       # package name
from = start_date,
to   = end_date) |>
mutate(date = as.Date(date))                 # ensure Date class
ggplot(dl, aes(date, count)) +
geom_col(width = 0.8) +
geom_smooth(method = "loess", se = FALSE) +
labs(title = "Daily CRAN downloads of DRPT",
x = NULL, y = "Downloads")
library(cranlogs)
library(dplyr)
library(ggplot2)
# DRPT hit CRAN on 2025-07-07; start there
start_date <- as.Date("2025-07-07")
end_date   <- Sys.Date()
dl <- cran_downloads("DRPT",                       # package name
from = start_date,
to   = end_date) |>
mutate(date = as.Date(date))                 # ensure Date class
ggplot(dl, aes(date, count)) +
geom_col(width = 0.8) +
geom_smooth(method = "loess", se = FALSE) +
labs(title = "Daily CRAN downloads of DRPT",
x = NULL, y = "Downloads")
sum(dl$count)
seq(50, 1050, by = 100)
seq(30, 300, by = 30)
# Combine pictures
library(magick)
files = c("experiments/pictures/4d_combinedAppendix copy.png",
"experiments/pictures/binaryRvarying copy.png"
)
imgs = image_read(files)
Pick a target height (use the smaller one to avoid upscaling artifacts)
# Pick a target height (use the smaller one to avoid upscaling artifacts)
target_h = min(image_info(imgs)$height)
imgs = image_read(files)
rm(list = ls())  # Clear environment
gc()             # Free memory
setwd("~/Documents/phd/projects/DRPT/code/simulationCpp/frisk")
library(latex2exp)
library(rootSolve)
library(DRPT)
set.seed(120720)
# Combine pictures
library(magick)
files = c("experiments/pictures/4d_combinedAppendix copy.png",
"experiments/pictures/binaryRvarying copy.png"
)
imgs = image_read(files)
# Pick a target height (use the smaller one to avoid upscaling artifacts)
target_h = min(image_info(imgs)$height)
# Scale each image to that exact height, preserving aspect ratio
imgs = image_scale(imgs, paste0("x", target_h))
# Draw (a)/(b)/(c)
label_draw = function(img, lab, x = 15, y = 35) {
info = image_info(img)
h = info$height
cex_val = max(1, h / 400)
img = image_draw(img)
par(mar = c(0,0,0,0), xpd = NA, family = "HersheySans")
# soft white box behind text
w  = strwidth(lab, cex = cex_val)
ht = strheight(lab, cex = cex_val)
rect(x - 6, y - 1.6*ht, x + 6 + 1.1*w, y + 6,
col = rgb(1,1,1,0.7), border = NA)
text(x, y, labels = lab, cex = cex_val, col = "black", adj = c(0, 1))
dev.off()
img
}
a = label_draw(imgs[1], "(a)")
b = label_draw(imgs[2], "(b)")
# Combine horizontally
combo = image_append(image_join(a, b), stack = FALSE)
image_write(combo, "results/combined_4.png")
rm(list = ls())  # Clear environment
gc()             # Free memory
setwd("~/Documents/phd/projects/DRPT/code/simulationCpp/frisk")
library(latex2exp)
library(rootSolve)
library(DRPT)
set.seed(120720)
# Combine pictures
library(magick)
files = c("experiments/pictures/4d_combinedAppendix copy.png",
"experiments/pictures/binaryRvarying copy.png")
imgs = image_read(files)
# Pick a target height (use the smaller one to avoid upscaling artifacts)
target_h = min(image_info(imgs)$height)
# Scale each image to that exact height, preserving aspect ratio
imgs = image_scale(imgs, paste0("x", target_h))
# Draw (a)/(b)/(c)
label_draw = function(img, lab, x = 15, y = 35) {
info = image_info(img)
h = info$height
cex_val = max(1, h / 400)
img = image_draw(img)
par(mar = c(0,0,0,0), xpd = NA, family = "HersheySans")
# soft white box behind text
w  = strwidth(lab, cex = cex_val)
ht = strheight(lab, cex = cex_val)
rect(x - 6, y - 1.6*ht, x + 6 + 1.1*w, y + 6,
col = rgb(1,1,1,0.7), border = NA)
text(x, y, labels = lab, cex = cex_val, col = "black", adj = c(0, 1))
dev.off()
img
}
a = label_draw(imgs[1], "(a)")
b = label_draw(imgs[2], "(b)")
# Combine horizontally
combo = image_append(image_join(a, b), stack = FALSE)
image_write(combo, "experiments/pictures/combined_4.png")
-------------------------------------------------------
# Combine pictures
library(magick)
# Combine pictures
library(magick)
files = c("experiments/pictures/binaryRvarying copy.png",
"experiments/pictures/4d_combinedAppendix copy.png"
)
imgs = image_read(files)
# Pick a target height (use the smaller one to avoid upscaling artifacts)
target_h = min(image_info(imgs)$height)
# Scale each image to that exact height, preserving aspect ratio
imgs = image_scale(imgs, paste0("x", target_h))
# Draw (a)/(b)/(c)
label_draw = function(img, lab, x = 15, y = 35) {
info = image_info(img)
h = info$height
cex_val = max(1, h / 400)
img = image_draw(img)
par(mar = c(0,0,0,0), xpd = NA, family = "HersheySans")
# soft white box behind text
w  = strwidth(lab, cex = cex_val)
ht = strheight(lab, cex = cex_val)
rect(x - 6, y - 1.6*ht, x + 6 + 1.1*w, y + 6,
col = rgb(1,1,1,0.7), border = NA)
text(x, y, labels = lab, cex = cex_val, col = "black", adj = c(0, 1))
dev.off()
img
}
a = label_draw(imgs[1], "(a)")
b = label_draw(imgs[2], "(b)")
# Combine horizontally
combo = image_append(image_join(a, b), stack = FALSE)
image_write(combo, "experiments/pictures/combined_4.png")
#------------------------------------------------------------------------------
# d = 2, varying r and show that close to 1 is harder
#------------------------------------------------------------------------------
rm(list = ls())  # Clear environment
gc()             # Free memory
setwd("~/Documents/phd/projects/DRPT/code/simulationCpp/synthetic/")
library(latex2exp)
library(rootSolve)
library(DRPT)
set.seed(221198)
n = 500; m = n
MC = 5000
# Preallocate a list to store data for each `m` value
all_results = list()
# Preparing the plot
png("experiments/pictures/binaryRvarying.png")
par(mfrow = c(1, 1))
plot(1, type = "n",  xlim = c(0,0.1), ylim = c(0,1),
xlab = TeX(r'($\eta$)', bold = TRUE),
ylab = "Power")
ind = 1
for (r2 in c(1/10, 1/2, 1, 2, 10)){
r = c(1, r2)
# Preallocate power and standard deviation vectors for efficiency
pow_vector = numeric(30)
# Precompute the alpha values
alpha_values = seq(from = 0, to = 0.1, length.out = 30)
# Main loop over alpha values
for (i in seq_along(alpha_values)) {
alpha = alpha_values[i]
gamma = 2*sqrt(r2)*alpha
# Preallocate the power for each iteration of MC
pow_alpha = numeric(MC)
for (M in 1:MC) {
# Sampling for X and Y based on the probabilities
X = rbinom(n, 1, 0.5)
Y = abs(rbinom(m, 1, (r2 + gamma)/(1+r2) ) - 0)
# Compute p-value using SPT
p_M_alpha = discrete.DRPT(X, Y,  r = r)
# Store whether the p-value is below 0.05 (for power calculation)
pow_alpha[M] = (p_M_alpha < 0.05)
}
# Store mean and standard deviation of power for this alpha
pow_vector[i] = mean(pow_alpha)
}
# Save the results for this `m` value into the list
all_results[[paste0("r_", r2)]] = data.frame(Alpha = alpha_values, Power = pow_vector)
# Plot
lines(alpha_values, pow_vector, type = "b", col = ind, lwd = 2, pch = 14 + ind)
ind = ind + 1
# # Plot
# lines(alpha_values, pow_vector, type = "b", col = 6 - ind, lwd = 2, pch = 20 - ind)
# ind = ind + 1
}
